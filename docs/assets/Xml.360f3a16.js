import{p as e,a as l,r as t,o as a,b as n,e as s,w as o,d as i,i as d,g as p}from"./vendor.66d56728.js";const r={name:"Xml",data:()=>({source:"",splitMode:void 0,plainText:void 0,thin:void 0,isMounted:!1}),computed:{format(){if(console.log("save"),this.isMounted&&this.save(),this.source=this.source.replace(/\n/g,"").replace(/\t/g," ").replace(/>[ ]+/g,">").replace(/[ ]+</g,"<").replace(/ +/g," "),this.splitMode)return this.formatXmlBySplit(this.source);{let e=this.formatXmlByDOMParser(this.source);if(this.thin){let l=e[2],t="";if(l)for(let e of l)e&&""!==e.replace(/[ ㅤ]*\t*/g,"")&&(t+=e);this.source=t}return e}}},mounted(){console.log("mounted"),this.get(),this.isMounted=!0},methods:{formatXmlByDOMParser(e){if(!e)return["",""];let l=null;const t=e.replace(/[\n\r]/g,"");try{l=(new DOMParser).parseFromString(t,"text/xml")}catch(n){return!1}let a=[[],[],[]];return console.log("--------------"),this.formatXmlWithDOMParser(a,l.documentElement,0),[a[0].join(""),a[1].join(""),a[2]]},formatXmlWithDOMParser(e,l,t){let a=l.nodeType,n="ㅤ",s=e[0],o=e[1],i=e[2];switch(a){case Node.ELEMENT_NODE:i.push("<"+l.nodeName+">"),s.push("".padStart(t*n.length,n)+"<"+l.nodeName+">"),s.push("\n"),o.push("".padStart(t*n.length,n)+`<span class="inline xml_item_${t}">&lt;${l.nodeName}></span>`),o.push("<br/>");for(let a=0;a<l.childNodes.length;a++)this.formatXmlWithDOMParser(e,l.childNodes[a],t+1);0===l.childNodes.length&&(s.splice(s.length-1,1),o.splice(o.length-1,1),n=""),l.childNodes[0]&&-1===[Node.ELEMENT_NODE,Node.COMMENT_NODE].indexOf(l.childNodes[0].nodeType)&&(s.splice(s.length-2,1),o.splice(o.length-2,1),n=""),i.push("</"+l.nodeName+">"),s.push("".padStart(t*n.length,n)+"</"+l.nodeName+">"),s.push("\n"),o.push("".padStart(t*n.length,n)+`<span class="inline xml_item_${t}">&lt;/${l.nodeName}></span>`),o.push("<br/>");break;case Node.TEXT_NODE:i.push(l.nodeValue),s.push(l.nodeValue),o.push(`<span class="inline xml_item_text">${l.nodeValue}</span>`);break;case Node.COMMENT_NODE:i.push("\x3c!-- "+l.nodeValue+" --\x3e"),s.push("".padStart(t*n.length,n)+"\x3c!-- "+l.nodeValue+" --\x3e"),s.push("\n"),o.push("".padStart(t*n.length,n)+`<span class="inline xml_item_${t}">&lt;!-- </span>`),o.push(`<span class="inline xml_item_comment">${l.nodeValue}</span>`),o.push(`<span class="inline xml_item_${t}"> --\x3e</span>`),o.push("<br/>");break;case Node.CDATA_SECTION_NODE:i.push(l.nodeValue),s.push(l.nodeValue),o.push(`<span class="inline xml_item_cdata">${l.nodeValue}</span>`)}},formatXmlBySplit(e){let l=e.replace(/<!\[CDATA\[[\s\S]*?]]>/g,(e=>`BEGIN_CDATA${encodeURIComponent(e)}END_CDATA`)).split("<");l=l.slice(1);let t=[];for(let c of l)if(c="<"+c,c.lastIndexOf(">")===c.length-1)t.push(c);else{let e=c.split(">");t.push(e[0]+">"),t.push(e[1])}let a=[];for(let c of t)c&&""!==c.trim()&&"\n"!==c.trim()&&a.push(c);let n=-1,s=[],o=[],i=!1,d=!0;for(let c of a){let e,l;c=c.replace(/BEGIN_CDATA.*?END_CDATA/g,(e=>decodeURIComponent(e.replace("BEGIN_CDATA","").replace("END_CDATA","")))),c=c.replace("<","&lt;"),c=c.replace(">","&gt;"),0===c.indexOf("&lt;?")&&c.lastIndexOf("?&gt;")===c.length-5||0===c.indexOf("&lt;!--")&&c.lastIndexOf("--&gt;")===c.length-6?(i||n++,i=!0,d=!1,e=`my_blank_word${c}\n`,l=`<div class="xml_item_${n}">my_blank_word<span>${c}</span></div>`):0===c.indexOf("&lt;![CDATA")?(i||n++,i=!0,d=!0,e=`my_blank_word${c}\n`,l=`<span class="xml_item_cdata">&lt;![CDATA[</span>${c.substring(12,c.length-6)}<span class="xml_item_cdata">]]&gt;</span>`,l=`<div class="xml_item_text">my_blank_word<span>${l}</span></div>`):0===c.indexOf("&lt;!")?(i||n++,i=!0,d=!1,e=`my_blank_word${c}\n`,l=`<div class="xml_item_${n}">my_blank_word<span>${c}</span></div>`):0===c.indexOf("&lt;/")?((d||i)&&n--,i=!0,d=!1,e=`my_blank_word${c}\n`,l=`<div class="xml_item_${n}">my_blank_word<span>${c}</span></div>`):0===c.indexOf("&lt;")&&c.lastIndexOf("/&gt;")===c.length-5?(i||n++,i=!0,d=!1,e=`my_blank_word${c}\n`,l=`<div class="xml_item_${n}">my_blank_word<span>${c}</span></div>`):0===c.indexOf("&lt;")?(i||n++,i=!1,d=!1,e=`my_blank_word${c}\n`,l=`<div class="xml_item_${n}">my_blank_word<span>${c}</span></div>`):(n++,i=!1,d=!0,e=`my_blank_word${c}\n`,l=`<div class="xml_item_text">my_blank_word<span>${c}</span></div>`);let t="",a="";for(let s=0;s<n;s++)t+='<span class="xml_space"></span>',a+="  ";e=e.replace("my_blank_word",a),l=l.replace("my_blank_word",t),o.push(l),s.push(e)}let p="",r="";for(let c of o)p+=c;for(let c of s)r+=c;return r=r.replace(/&lt;/g,"<"),r=r.replace(/&gt;/g,">"),[r,p]},save(){let e={source:this.source,plainText:this.plainText,thin:this.thin,splitMode:this.splitMode};localStorage.setItem("xmlData",JSON.stringify(e))},get(){let e;try{e=JSON.parse(localStorage.getItem("xmlData"))}catch(l){}e||(e={source:"",plainText:!0,thin:!0,splitMode:!0}),this.source=e.source,this.plainText=e.plainText,this.thin=e.thin,this.splitMode=e.splitMode,console.log(this.pretty)}}};e("data-v-6c8a13c4");const c={class:"xml"},m={class:"buttons"},u=i("span",null,"Show Plain Text:",-1),h=i("span",null,"Mode Switch:",-1),_={key:0},f=i("span",null,"Thin:",-1),x=["innerHTML"];l(),r.render=function(e,l,r,g,v,N){const T=t("el-switch"),y=t("el-card"),$=t("el-row"),O=t("el-input"),M=t("el-col");return a(),n("div",c,[s($,{class:"options"},{default:o((()=>[s(y,null,{default:o((()=>[i("div",m,[i("div",null,[u,s(T,{modelValue:v.plainText,"onUpdate:modelValue":l[0]||(l[0]=e=>v.plainText=e),"active-color":"#13ce66","inactive-color":"#ff4949",onChange:N.save},null,8,["modelValue","onChange"])]),i("div",null,[h,s(T,{modelValue:v.splitMode,"onUpdate:modelValue":l[1]||(l[1]=e=>v.splitMode=e),"active-color":"#13ce66","inactive-color":"#ff4949",onChange:N.save},null,8,["modelValue","onChange"])]),v.splitMode?d("",!0):(a(),n("div",_,[f,s(T,{modelValue:v.thin,"onUpdate:modelValue":l[2]||(l[2]=e=>v.thin=e),"active-color":"#13ce66","inactive-color":"#ff4949",onChange:N.save},null,8,["modelValue","onChange"])]))])])),_:1})])),_:1}),s($,{gutter:10,class:"content"},{default:o((()=>[s(M,{span:8},{default:o((()=>[s(O,{modelValue:v.source,"onUpdate:modelValue":l[3]||(l[3]=e=>v.source=e),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])])),_:1}),v.plainText?(a(),p(M,{key:0,span:8},{default:o((()=>[s(O,{modelValue:N.format[0],"onUpdate:modelValue":l[4]||(l[4]=e=>N.format[0]=e),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])])),_:1})):d("",!0),s(M,{span:v.plainText?8:16},{default:o((()=>[i("div",{class:"result",innerHTML:N.format[1]},null,8,x)])),_:1},8,["span"])])),_:1})])},r.__scopeId="data-v-6c8a13c4";export{r as default};
