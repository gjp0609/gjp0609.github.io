import{_ as O,a as y,c as w,g as m,w as x,e as g,i as h,k as D,f as b,p as M,l as V}from"./index.bceb44ba.js";const C={name:"Xml",data(){return{source:"",splitMode:void 0,plainText:void 0,thin:void 0,isMounted:!1}},computed:{format(){if(console.log("save"),this.isMounted&&this.save(),this.source=this.source.replace(/\n/g,"").replace(/\t/g," ").replace(/>[ ]+/g,">").replace(/[ ]+</g,"<").replace(/ +/g," "),this.splitMode)return this.formatXmlBySplit(this.source);{let a=this.formatXmlByDOMParser(this.source);if(this.thin){let t=a[2],o="";if(t)for(let r of t)r&&r.replace(/[ ã…¤]*\t*/g,"")!==""&&(o+=r);this.source=o}return a}}},mounted(){console.log("mounted"),this.get(),this.isMounted=!0},methods:{formatXmlByDOMParser(a){if(!a)return["",""];let t=null;const o=a.replace(/[\n\r]/g,"");try{t=new DOMParser().parseFromString(o,"text/xml")}catch{return!1}let r=[[],[],[]];return console.log("--------------"),this.formatXmlWithDOMParser(r,t.documentElement,0),[r[0].join(""),r[1].join(""),r[2]]},formatXmlWithDOMParser(a,t,o){let r=t.nodeType,s="\u3164",l=a[0],i=a[1],_=a[2];switch(r){case Node.ELEMENT_NODE:_.push("<"+t.nodeName+">"),l.push("".padStart(o*s.length,s)+"<"+t.nodeName+">"),l.push(`
`),i.push("".padStart(o*s.length,s)+`<span class="inline xml_item_${o}">&lt;${t.nodeName}></span>`),i.push("<br/>");for(let n=0;n<t.childNodes.length;n++)this.formatXmlWithDOMParser(a,t.childNodes[n],o+1);t.childNodes.length===0&&(l.splice(l.length-1,1),i.splice(i.length-1,1),s=""),t.childNodes[0]&&[Node.ELEMENT_NODE,Node.COMMENT_NODE].indexOf(t.childNodes[0].nodeType)===-1&&(l.splice(l.length-2,1),i.splice(i.length-2,1),s=""),_.push("</"+t.nodeName+">"),l.push("".padStart(o*s.length,s)+"</"+t.nodeName+">"),l.push(`
`),i.push("".padStart(o*s.length,s)+`<span class="inline xml_item_${o}">&lt;/${t.nodeName}></span>`),i.push("<br/>");break;case Node.TEXT_NODE:_.push(t.nodeValue),l.push(t.nodeValue),i.push(`<span class="inline xml_item_text">${t.nodeValue}</span>`);break;case Node.COMMENT_NODE:_.push("<!-- "+t.nodeValue+" -->"),l.push("".padStart(o*s.length,s)+"<!-- "+t.nodeValue+" -->"),l.push(`
`),i.push("".padStart(o*s.length,s)+`<span class="inline xml_item_${o}">&lt;!-- </span>`),i.push(`<span class="inline xml_item_comment">${t.nodeValue}</span>`),i.push(`<span class="inline xml_item_${o}"> --></span>`),i.push("<br/>");break;case Node.CDATA_SECTION_NODE:_.push(t.nodeValue),l.push(t.nodeValue),i.push(`<span class="inline xml_item_cdata">${t.nodeValue}</span>`);break}},formatXmlBySplit(a){let o=a.replace(/<!\[CDATA\[[\s\S]*?]]>/g,e=>`BEGIN_CDATA${encodeURIComponent(e)}END_CDATA`).split("<");o=o.slice(1);let r=[];for(let e of o)if(e="<"+e,e.lastIndexOf(">")===e.length-1)r.push(e);else{let p=e.split(">");r.push(p[0]+">"),r.push(p[1])}let s=[];for(let e of r)e&&e.trim()!==""&&e.trim()!==`
`&&s.push(e);let l=-1,i=[],_=[],n=!1,u=!0;for(let e of s){let p,c;e=e.replace(/BEGIN_CDATA.*?END_CDATA/g,N=>decodeURIComponent(N.replace("BEGIN_CDATA","").replace("END_CDATA",""))),e=e.replace("<","&lt;"),e=e.replace(">","&gt;"),e.indexOf("&lt;?")===0&&e.lastIndexOf("?&gt;")===e.length-5?(n||l++,n=!0,u=!1,p=`my_blank_word${e}
`,c=`<div class="xml_item_${l}">my_blank_word<span>${e}</span></div>`):e.indexOf("&lt;!--")===0&&e.lastIndexOf("--&gt;")===e.length-6?(n||l++,n=!0,u=!1,p=`my_blank_word${e}
`,c=`<div class="xml_item_${l}">my_blank_word<span>${e}</span></div>`):e.indexOf("&lt;![CDATA")===0?(n||l++,n=!0,u=!0,p=`my_blank_word${e}
`,c=`<span class="xml_item_cdata">&lt;![CDATA[</span>${e.substring(12,e.length-6)}<span class="xml_item_cdata">]]&gt;</span>`,c=`<div class="xml_item_text">my_blank_word<span>${c}</span></div>`):e.indexOf("&lt;!")===0?(n||l++,n=!0,u=!1,p=`my_blank_word${e}
`,c=`<div class="xml_item_${l}">my_blank_word<span>${e}</span></div>`):e.indexOf("&lt;/")===0?((u||n)&&l--,n=!0,u=!1,p=`my_blank_word${e}
`,c=`<div class="xml_item_${l}">my_blank_word<span>${e}</span></div>`):e.indexOf("&lt;")===0&&e.lastIndexOf("/&gt;")===e.length-5?(n||l++,n=!0,u=!1,p=`my_blank_word${e}
`,c=`<div class="xml_item_${l}">my_blank_word<span>${e}</span></div>`):e.indexOf("&lt;")===0?(n||l++,n=!1,u=!1,p=`my_blank_word${e}
`,c=`<div class="xml_item_${l}">my_blank_word<span>${e}</span></div>`):(l++,n=!1,u=!0,p=`my_blank_word${e}
`,c=`<div class="xml_item_text">my_blank_word<span>${e}</span></div>`);let v="",k="";for(let N=0;N<l;N++)v+='<span class="xml_space"></span>',k+="  ";p=p.replace("my_blank_word",k),c=c.replace("my_blank_word",v),_.push(c),i.push(p)}let f="",d="";for(let e of _)f+=e;for(let e of i)d+=e;return d=d.replace(/&lt;/g,"<"),d=d.replace(/&gt;/g,">"),[d,f]},save(){let a={source:this.source,plainText:this.plainText,thin:this.thin,splitMode:this.splitMode};localStorage.setItem("xmlData",JSON.stringify(a))},get(){let a;try{a=JSON.parse(localStorage.getItem("xmlData"))}catch{}a||(a={source:"",plainText:!0,thin:!0,splitMode:!0}),this.source=a.source,this.plainText=a.plainText,this.thin=a.thin,this.splitMode=a.splitMode,console.log(this.pretty)}}},T=a=>(M("data-v-6c8a13c4"),a=a(),V(),a),E={class:"xml"},S={class:"buttons"},A=T(()=>h("span",null,"Show Plain Text:",-1)),$=T(()=>h("span",null,"Mode Switch:",-1)),I={key:0},B=T(()=>h("span",null,"Thin:",-1)),X=["innerHTML"];function P(a,t,o,r,s,l){const i=g("el-switch"),_=g("el-card"),n=g("el-row"),u=g("el-input"),f=g("el-col");return y(),w("div",E,[m(n,{class:"options"},{default:x(()=>[m(_,null,{default:x(()=>[h("div",S,[h("div",null,[A,m(i,{modelValue:s.plainText,"onUpdate:modelValue":t[0]||(t[0]=d=>s.plainText=d),"active-color":"#13ce66","inactive-color":"#ff4949",onChange:l.save},null,8,["modelValue","onChange"])]),h("div",null,[$,m(i,{modelValue:s.splitMode,"onUpdate:modelValue":t[1]||(t[1]=d=>s.splitMode=d),"active-color":"#13ce66","inactive-color":"#ff4949",onChange:l.save},null,8,["modelValue","onChange"])]),s.splitMode?D("",!0):(y(),w("div",I,[B,m(i,{modelValue:s.thin,"onUpdate:modelValue":t[2]||(t[2]=d=>s.thin=d),"active-color":"#13ce66","inactive-color":"#ff4949",onChange:l.save},null,8,["modelValue","onChange"])]))])]),_:1})]),_:1}),m(n,{gutter:10,class:"content"},{default:x(()=>[m(f,{span:8},{default:x(()=>[m(u,{modelValue:s.source,"onUpdate:modelValue":t[3]||(t[3]=d=>s.source=d),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},null,8,["modelValue"])]),_:1}),s.plainText?(y(),b(f,{key:0,span:8},{default:x(()=>[m(u,{modelValue:l.format[0],"onUpdate:modelValue":t[4]||(t[4]=d=>l.format[0]=d),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},null,8,["modelValue"])]),_:1})):D("",!0),m(f,{span:s.plainText?8:16},{default:x(()=>[h("div",{class:"result",innerHTML:l.format[1]},null,8,X)]),_:1},8,["span"])]),_:1})])}var L=O(C,[["render",P],["__scopeId","data-v-6c8a13c4"]]);export{L as default};
